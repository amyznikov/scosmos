############################################################
#
# ssa-plate-dump Makefile
# Generated by amyznikov Feb 15, 2013
#   from 'linux-gcc executable' template
#
############################################################

TARGET=ssa-plate-dump
all : $(TARGET)


ifndef prefix
prefix=/usr/local
endif

ifndef cc
cc=gcc
endif

bindir=$(prefix)/bin


SUBDIRS = .

INCLUDES+=$(foreach s,$(SUBDIRS),-I$(s)) -I../include
SOURCES = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.c))
HEADERS = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.h $(s)/*.hpp ))
MODULES = $(foreach s,$(SOURCES),$(addsuffix .o,$(basename $(s))))
DEFINES =
LDLIBS  += -lm


#########################################
# ICC DEFS
#
ifeq ($(strip $(cc)),icc)

export LC_CTYPE=C
# C preprocessor flags
CPPFLAGS=

# C Compiler and flags
CC=icc
CFLAGS=-O3 -fast -Ofast $(DEFINES) $(INCLUDES) \
  -g0 -fno-strict-aliasing

# C++ Compiler and flags
CXX=icc
CXXFLAGS=$(CFLAGS)

# Fortran compiler and flags
FC=ifort
FFLAGS=-O3 -ftz

# Loader Flags And Libraries
LD=$(CC)
LDFLAGS = $(CFLAGS)
LDLIBS +=
endif



#########################################
#
# GCC DEFS
#
ifeq ($(strip $(cc)),gcc)

# C preprocessor flags
CPPFLAGS=

# C Compiler and flags
CC=gcc
CFLAGS=-O3 $(DEFINES) $(INCLUDES) \
  -g0 -Wall -Wextra -fexpensive-optimizations -ffast-math -fassociative-math -fno-signed-zeros -fno-strict-aliasing

# C++ Compiler and flags
CXX=gcc
CXXFLAGS=$(CFLAGS)

# Fortran compiler and flags
FC=gfortran
FFLAGS=-O3

# Loader Flags And Libraries
LD=$(CC)
LDFLAGS = $(CFLAGS)
LDLIBS +=
endif



#########################################



$(MODULES): $(HEADERS) Makefile
$(TARGET) : $(MODULES)
	$(LD) $(LDFLAGS) -o $@ $(MODULES) $(LDLIBS) && strip --strip-all $@

clean:
	$(RM) $(MODULES)

distclean:
	$(RM) $(MODULES) $(TARGET)

install: $(bindir)
	cp $(TARGET) $(bindir)/

$(bindir):
	mkdir -p $(bindir)

