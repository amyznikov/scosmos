############################################################
#
# pairstars Makefile
# Generated by amyznikov June 18, 2013
#
############################################################

TARGET = ssa-pair-stars
all : $(TARGET)

ifndef prefix
prefix=/usr/local
endif

ifndef cc
cc=gcc
endif

bindir=$(prefix)/bin


SUBDIRS = .

INCLUDES+=$(foreach s,$(SUBDIRS),-I$(s)) -I../include
SOURCES = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.c $(s)/*.cc $(s)/*.cpp $(s)/*.cxx $(s)/*.S))
HEADERS = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.h $(s)/*.hpp ))
MODULES = $(foreach s,$(SOURCES),$(addsuffix .o,$(basename $(s))))
DEFINES =
LDLIBS  += -lm

ifndef cc
cc=gcc
endif

#########################################
# ICC DEFS
#
ifeq ($(strip $(cc)),icc)

export LC_CTYPE=C
# C preprocessor flags
CPPFLAGS=

# C Compiler and flags
CC=icc
CFLAGS= -Wall -Wextra -O3 -ftz $(DEFINES) $(INCLUDES)

# C++ Compiler and flags
CXX=icc
CXXFLAGS=$(CFLAGS)

# Fortran compiler and flags
FC=ifort
FFLAGS=-O3 -ftz

# Loader Flags And Libraries
LD=$(CC)
LDFLAGS = $(CFLAGS)
LDLIBS += 
endif



#########################################
#
# GCC DEFS
#
ifeq ($(strip $(cc)),gcc)

# C preprocessor flags
CPPFLAGS=

# C Compiler and flags
CC=gcc
CFLAGS= -Wall -Wextra -O3 $(DEFINES) $(INCLUDES)

# C++ Compiler and flags
CXX=gcc
CXXFLAGS=$(CFLAGS)

# Fortran compiler and flags
FC=gfortran
FFLAGS=-O3

# Loader Flags And Libraries
LD=$(CC)
LDFLAGS = $(CFLAGS)
LDLIBS +=
endif



#########################################


$(MODULES): $(HEADERS)
$(TARGET) : $(MODULES)
	$(LD) $(LDFLAGS) -o $@ $(MODULES) $(LDLIBS)

clean:
	$(RM) $(MODULES)

distclean:
	$(RM) $(MODULES) $(TARGET)

install: $(bindir)
	cp $(TARGET) $(bindir)/

$(bindir):
	mkdir -p $(bindir)

